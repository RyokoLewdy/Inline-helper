<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Profile Design Generator</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        
        .container {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 209, 214, 0.3);
        }
        
        #canvas {
            border: 2px solid #39C5BB;
            border-radius: 20px;
            cursor: crosshair;
        }
        
        .controls-wrapper {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            width: 100%;
            max-width: 1400px;
        }
        
        .control-section {
            background: rgba(57, 197, 187, 0.05);
            padding: 20px;
            border-radius: 20px;
            border: 2px solid #39C5BB;
        }
        
        .section-title {
            color: #00D1D6;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid #39C5BB;
            padding-bottom: 10px;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-label {
            color: #39C5BB;
            font-size: 13px;
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
        }
        
        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 8px 12px;
            background: #2a2a2a;
            border: 2px solid #39C5BB;
            border-radius: 10px;
            color: white;
            font-size: 14px;
        }
        
        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: #00D1D6;
            box-shadow: 0 0 10px rgba(0, 209, 214, 0.3);
        }
        
        input[type="range"] {
            width: 100%;
            cursor: pointer;
            accent-color: #39C5BB;
        }
        
        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #39C5BB;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .color-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .color-picker {
            width: 50px;
            height: 50px;
            border: 2px solid #39C5BB;
            border-radius: 10px;
            cursor: pointer;
        }
        
        .hex-input {
            flex: 1;
        }
        
        button {
            background: linear-gradient(135deg, #39C5BB, #00D1D6);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            width: 100%;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(57, 197, 187, 0.5);
        }
        
        .upload-btn {
            background: linear-gradient(135deg, #FF6B9D, #FF8DB3);
        }
        
        input[type="file"] {
            display: none;
        }
        
        .preview-box {
            width: 100%;
            height: 150px;
            border: 2px dashed #39C5BB;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background: rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }
        
        .preview-box img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .value-display {
            color: #FF6B9D;
            font-size: 12px;
            font-weight: bold;
            text-align: right;
            margin-top: 5px;
        }
        
        h1 {
            color: #00D1D6;
            text-align: center;
            text-shadow: 0 0 20px rgba(0, 209, 214, 0.5);
            margin: 0;
        }
        
        .info {
            color: #FF6B9D;
            text-align: center;
            font-size: 14px;
        }
        
        .main-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .main-controls button {
            width: auto;
            min-width: 200px;
        }
    </style>
</head>
<body>
    <h1>üé® Universal Profile Design Generator üé®</h1>
    <p class="info">1920x1080 | Fully Customizable | Download as PNG</p>
    
    <div class="controls-wrapper">
        <!-- Text Settings -->
        <div class="control-section">
            <div class="section-title">üìù Text Settings</div>
            
            <div class="control-group">
                <label class="control-label">Main Text</label>
                <input type="text" id="mainText" value="Miku" oninput="redraw()">
            </div>
            
            <div class="control-group">
                <label class="control-label">Subtitle Text</label>
                <input type="text" id="subtitleText" value="Hatsune" oninput="redraw()">
            </div>
            
            <div class="control-group">
                <label class="control-label">Main Font</label>
                <select id="mainFont" onchange="redraw()">
                    <option value="Comic Sans MS">Comic Sans MS (Default)</option>
                    <option value="Impact">Impact</option>
                    <option value="Arial Black">Arial Black</option>
                    <option value="Brush Script MT">Brush Script MT</option>
                    <option value="Courier New">Courier New</option>
                    <option value="Georgia">Georgia</option>
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Trebuchet MS">Trebuchet MS</option>
                    <option value="Verdana">Verdana</option>
                    <option value="Marker Felt">Marker Felt</option>
                </select>
            </div>
            
            <div class="control-group">
                <label class="control-label">Subtitle Font</label>
                <select id="subtitleFont" onchange="redraw()">
                    <option value="Trebuchet MS">Trebuchet MS (Default)</option>
                    <option value="Arial">Arial</option>
                    <option value="Helvetica">Helvetica</option>
                    <option value="Impact">Impact</option>
                    <option value="Georgia">Georgia</option>
                    <option value="Courier New">Courier New</option>
                    <option value="Verdana">Verdana</option>
                    <option value="Times New Roman">Times New Roman</option>
                </select>
            </div>
            
            <div class="control-group">
                <label class="control-label">Main Text Size: <span id="mainSizeValue">85px</span></label>
                <input type="range" id="mainTextSize" min="40" max="150" value="85" oninput="updateValue('mainSize', this.value); redraw()">
            </div>
            
            <div class="control-group">
                <label class="control-label">Subtitle Size: <span id="subtitleSizeValue">38px</span></label>
                <input type="range" id="subtitleTextSize" min="20" max="80" value="38" oninput="updateValue('subtitleSize', this.value); redraw()">
            </div>
        </div>
        
        <!-- Banner Settings -->
        <div class="control-section">
            <div class="section-title">üè∑Ô∏è Banner Settings</div>
            
            <div class="control-group">
                <label class="control-label">Banner Shape</label>
                <select id="bannerShape" onchange="redraw()">
                    <option value="rounded">Rounded Rectangle (Default)</option>
                    <option value="rectangle">Sharp Rectangle</option>
                    <option value="hexagon">Hexagon</option>
                    <option value="ellipse">Ellipse</option>
                    <option value="diamond">Diamond</option>
                </select>
            </div>
            
            <div class="control-group">
                <label class="control-label">Banner Width: <span id="bannerWidthValue">780px</span></label>
                <input type="range" id="bannerWidth" min="400" max="1200" value="780" oninput="updateValue('bannerWidth', this.value); redraw()">
            </div>
            
            <div class="control-group">
                <label class="control-label">Banner Height: <span id="bannerHeightValue">140px</span></label>
                <input type="range" id="bannerHeight" min="80" max="250" value="140" oninput="updateValue('bannerHeight', this.value); redraw()">
            </div>
            
            <div class="control-group">
                <label class="control-label">Banner Color</label>
                <div class="color-input-group">
                    <input type="color" id="bannerColorPicker" value="#39C5BB" class="color-picker" oninput="syncColor('bannerColor', this.value)">
                    <input type="text" id="bannerColorHex" value="#39C5BB" class="hex-input" oninput="syncColorFromHex('bannerColor', this.value)" placeholder="#39C5BB">
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">Banner Rotation: <span id="bannerRotValue">-3¬∞</span></label>
                <input type="range" id="bannerRotation" min="-45" max="45" value="-3" oninput="updateValue('bannerRot', this.value); redraw()">
            </div>
            
            <div class="control-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="showSparkles" checked onchange="redraw()">
                    <label class="control-label">Show Sparkles</label>
                </div>
            </div>
        </div>
        
        <!-- Background Elements -->
        <div class="control-section">
            <div class="section-title">üåü Background Elements</div>
            
            <div class="control-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="showDigitalCode" checked onchange="redraw()">
                    <label class="control-label">Show Digital Code</label>
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">Digital Code Text</label>
                <input type="text" id="digitalCodeText" value="01" maxlength="30" oninput="redraw()">
            </div>
            
            <div class="control-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="showMusicNotes" checked onchange="redraw()">
                    <label class="control-label">Show Music Notes</label>
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">Music Note Symbol</label>
                <select id="musicNoteSymbol" onchange="redraw()">
                    <option value="‚ô™">‚ô™ (Single)</option>
                    <option value="‚ô´">‚ô´ (Double)</option>
                    <option value="‚ô¨">‚ô¨ (Beamed)</option>
                    <option value="‚òÖ">‚òÖ (Star)</option>
                    <option value="‚ô•">‚ô• (Heart)</option>
                    <option value="‚ú¶">‚ú¶ (Sparkle)</option>
                    <option value="‚óÜ">‚óÜ (Diamond)</option>
                </select>
            </div>
            
            <div class="control-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="showTempBg" onchange="redraw()">
                    <label class="control-label">Show Temp Background (Preview Only)</label>
                </div>
            </div>
        </div>
        
        <!-- Colors -->
        <div class="control-section">
            <div class="section-title">üé® Color Scheme</div>
            
            <div class="control-group">
                <label class="control-label">Primary Color</label>
                <div class="color-input-group">
                    <input type="color" id="primaryColorPicker" value="#39C5BB" class="color-picker" oninput="syncColor('primaryColor', this.value)">
                    <input type="text" id="primaryColorHex" value="#39C5BB" class="hex-input" oninput="syncColorFromHex('primaryColor', this.value)" placeholder="#39C5BB">
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">Accent Color</label>
                <div class="color-input-group">
                    <input type="color" id="accentColorPicker" value="#FF6B9D" class="color-picker" oninput="syncColor('accentColor', this.value)">
                    <input type="text" id="accentColorHex" value="#FF6B9D" class="hex-input" oninput="syncColorFromHex('accentColor', this.value)" placeholder="#FF6B9D">
                </div>
            </div>
        </div>
    </div>
    
    <!-- Image Upload Sections -->
    <div class="controls-wrapper">
        <!-- Main Cutout -->
        <div class="control-section">
            <div class="section-title">üéµ Main Cutout Image</div>
            <div class="preview-box" id="preview-cutout"></div>
            <button class="upload-btn" onclick="document.getElementById('cutout').click()">Upload Image</button>
            <input type="file" id="cutout" accept="image/*" onchange="handleImageUpload(event, 'cutout', 0)">
            
            <div class="control-group" style="margin-top: 15px;">
                <label class="control-label">Opacity: <span id="value-cutout-op">100%</span></label>
                <input type="range" id="opacity-cutout" min="0" max="100" value="100" oninput="updateOpacity('cutout', 0, this.value)">
            </div>
        </div>
        
        <!-- Large Diamonds -->
        <div class="control-section">
            <div class="section-title">üì∏ Large Diamond 1</div>
            <div class="preview-box" id="preview-large-1"></div>
            <button class="upload-btn" onclick="document.getElementById('large-1').click()">Upload Image</button>
            <input type="file" id="large-1" accept="image/*" onchange="handleImageUpload(event, 'large', 0)">
            
            <div class="control-group" style="margin-top: 15px;">
                <label class="control-label">Size: <span id="value-large-1-size">330px</span></label>
                <input type="range" id="size-large-1" min="150" max="500" value="330" oninput="updateDiamondSize('large', 0, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Rotation: <span id="value-large-1-rot">45¬∞</span></label>
                <input type="range" id="rotation-large-1" min="-180" max="180" value="45" oninput="updateDiamondRotation('large', 0, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Opacity: <span id="value-large-1-op">100%</span></label>
                <input type="range" id="opacity-large-1" min="0" max="100" value="100" oninput="updateOpacity('large', 0, this.value)">
            </div>
        </div>
        
        <div class="control-section">
            <div class="section-title">üì∏ Large Diamond 2</div>
            <div class="preview-box" id="preview-large-2"></div>
            <button class="upload-btn" onclick="document.getElementById('large-2').click()">Upload Image</button>
            <input type="file" id="large-2" accept="image/*" onchange="handleImageUpload(event, 'large', 1)">
            
            <div class="control-group" style="margin-top: 15px;">
                <label class="control-label">Size: <span id="value-large-2-size">300px</span></label>
                <input type="range" id="size-large-2" min="150" max="500" value="300" oninput="updateDiamondSize('large', 1, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Rotation: <span id="value-large-2-rot">15¬∞</span></label>
                <input type="range" id="rotation-large-2" min="-180" max="180" value="15" oninput="updateDiamondRotation('large', 1, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Opacity: <span id="value-large-2-op">100%</span></label>
                <input type="range" id="opacity-large-2" min="0" max="100" value="100" oninput="updateOpacity('large', 1, this.value)">
            </div>
        </div>
        
        <div class="control-section">
            <div class="section-title">üì∏ Large Diamond 3</div>
            <div class="preview-box" id="preview-large-3"></div>
            <button class="upload-btn" onclick="document.getElementById('large-3').click()">Upload Image</button>
            <input type="file" id="large-3" accept="image/*" onchange="handleImageUpload(event, 'large', 2)">
            
            <div class="control-group" style="margin-top: 15px;">
                <label class="control-label">Size: <span id="value-large-3-size">280px</span></label>
                <input type="range" id="size-large-3" min="150" max="500" value="280" oninput="updateDiamondSize('large', 2, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Rotation: <span id="value-large-3-rot">-20¬∞</span></label>
                <input type="range" id="rotation-large-3" min="-180" max="180" value="-20" oninput="updateDiamondRotation('large', 2, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Opacity: <span id="value-large-3-op">100%</span></label>
                <input type="range" id="opacity-large-3" min="0" max="100" value="100" oninput="updateOpacity('large', 2, this.value)">
            </div>
        </div>
        
        <!-- Small Diamonds -->
        <div class="control-section">
            <div class="section-title">üì∏ Small Diamond 1</div>
            <div class="preview-box" id="preview-small-1"></div>
            <button class="upload-btn" onclick="document.getElementById('small-1').click()">Upload Image</button>
            <input type="file" id="small-1" accept="image/*" onchange="handleImageUpload(event, 'small', 0)">
            
            <div class="control-group" style="margin-top: 15px;">
                <label class="control-label">Size: <span id="value-small-1-size">80px</span></label>
                <input type="range" id="size-small-1" min="50" max="150" value="80" oninput="updateDiamondSize('small', 0, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Rotation: <span id="value-small-1-rot">45¬∞</span></label>
                <input type="range" id="rotation-small-1" min="-180" max="180" value="45" oninput="updateDiamondRotation('small', 0, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Opacity: <span id="value-small-1-op">100%</span></label>
                <input type="range" id="opacity-small-1" min="0" max="100" value="100" oninput="updateOpacity('small', 0, this.value)">
            </div>
        </div>
        
        <div class="control-section">
            <div class="section-title">üì∏ Small Diamond 2</div>
            <div class="preview-box" id="preview-small-2"></div>
            <button class="upload-btn" onclick="document.getElementById('small-2').click()">Upload Image</button>
            <input type="file" id="small-2" accept="image/*" onchange="handleImageUpload(event, 'small', 1)">
            
            <div class="control-group" style="margin-top: 15px;">
                <label class="control-label">Size: <span id="value-small-2-size">80px</span></label>
                <input type="range" id="size-small-2" min="50" max="150" value="80" oninput="updateDiamondSize('small', 1, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Rotation: <span id="value-small-2-rot">45¬∞</span></label>
                <input type="range" id="rotation-small-2" min="-180" max="180" value="45" oninput="updateDiamondRotation('small', 1, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Opacity: <span id="value-small-2-op">100%</span></label>
                <input type="range" id="opacity-small-2" min="0" max="100" value="100" oninput="updateOpacity('small', 1, this.value)">
            </div>
        </div>
        
        <div class="control-section">
            <div class="section-title">üì∏ Small Diamond 3</div>
            <div class="preview-box" id="preview-small-3"></div>
            <button class="upload-btn" onclick="document.getElementById('small-3').click()">Upload Image</button>
            <input type="file" id="small-3" accept="image/*" onchange="handleImageUpload(event, 'small', 2)">
            
            <div class="control-group" style="margin-top: 15px;">
                <label class="control-label">Size: <span id="value-small-3-size">80px</span></label>
                <input type="range" id="size-small-3" min="50" max="150" value="80" oninput="updateDiamondSize('small', 2, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Rotation: <span id="value-small-3-rot">45¬∞</span></label>
                <input type="range" id="rotation-small-3" min="-180" max="180" value="45" oninput="updateDiamondRotation('small', 2, this.value)">
            </div>
            
            <div class="control-group">
                <label class="control-label">Opacity: <span id="value-small-3-op">100%</span></label>
                <input type="range" id="opacity-small-3" min="0" max="100" value="100" oninput="updateOpacity('small', 2, this.value)">
            </div>
        </div>
    </div>
    
    <div class="container">
        <canvas id="canvas" width="2100" height="1200"></canvas>
    </div>
    
    <div class="main-controls">
        <button onclick="resetToDefaults()">üîÑ Reset to Defaults</button>
        <button onclick="redraw()">üé® Redraw Canvas</button>
        <button onclick="downloadImage()">üíæ Download PNG (1920x1080)</button>
    </div>
    
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        const SAFE_ZONE = {
            x: 90,
            y: 60,
            width: 1920,
            height: 1080
        };
        
        let primaryColor = '#39C5BB';
        let accentColor = '#FF6B9D';
        let bannerColor = '#39C5BB';
        
        let largeImages = [null, null, null];
        let smallImages = [null, null, null];
        let mikuCutout = null;
        
        let largeOpacity = [100, 100, 100];
        let smallOpacity = [100, 100, 100];
        let cutoutOpacity = 100;
        
        let largeSizes = [330, 300, 280];
        let smallSizes = [80, 80, 80];
        let largeRotations = [45, 15, -20];
        let smallRotations = [45, 45, 45];
        
        function syncColor(type, value) {
            if (type === 'primaryColor') {
                primaryColor = value;
                document.getElementById('primaryColorHex').value = value;
                document.getElementById('primaryColorPicker').value = value;
            } else if (type === 'accentColor') {
                accentColor = value;
                document.getElementById('accentColorHex').value = value;
                document.getElementById('accentColorPicker').value = value;
            } else if (type === 'bannerColor') {
                bannerColor = value;
                document.getElementById('bannerColorHex').value = value;
                document.getElementById('bannerColorPicker').value = value;
            }
            redraw();
        }
        
        function syncColorFromHex(type, value) {
            if (!/^#[0-9A-F]{6}$/i.test(value)) return;
            syncColor(type, value);
        }
        
        function updateValue(id, value) {
            const suffixes = {
                'mainSize': 'px',
                'subtitleSize': 'px',
                'bannerWidth': 'px',
                'bannerHeight': 'px',
                'bannerRot': '¬∞'
            };
            document.getElementById(id + 'Value').textContent = value + suffixes[id];
        }
        
        function updateOpacity(type, index, value) {
            if (type === 'cutout') {
                cutoutOpacity = parseInt(value);
                document.getElementById('value-cutout-op').textContent = value + '%';
            } else if (type === 'large') {
                largeOpacity[index] = parseInt(value);
                document.getElementById(`value-large-${index + 1}-op`).textContent = value + '%';
            } else if (type === 'small') {
                smallOpacity[index] = parseInt(value);
                document.getElementById(`value-small-${index + 1}-op`).textContent = value + '%';
            }
            redraw();
        }
        
        function updateDiamondSize(type, index, value) {
            if (type === 'large') {
                largeSizes[index] = parseInt(value);
                document.getElementById(`value-large-${index + 1}-size`).textContent = value + 'px';
            } else if (type === 'small') {
                smallSizes[index] = parseInt(value);
                document.getElementById(`value-small-${index + 1}-size`).textContent = value + 'px';
            }
            redraw();
        }
        
        function updateDiamondRotation(type, index, value) {
            if (type === 'large') {
                largeRotations[index] = parseInt(value);
                document.getElementById(`value-large-${index + 1}-rot`).textContent = value + '¬∞';
            } else if (type === 'small') {
                smallRotations[index] = parseInt(value);
                document.getElementById(`value-small-${index + 1}-rot`).textContent = value + '¬∞';
            }
            redraw();
        }
        
        function handleImageUpload(event, type, index) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    if (type === 'large') {
                        largeImages[index] = img;
                        document.getElementById(`preview-large-${index + 1}`).innerHTML = `<img src="${e.target.result}">`;
                    } else if (type === 'small') {
                        smallImages[index] = img;
                        document.getElementById(`preview-small-${index + 1}`).innerHTML = `<img src="${e.target.result}">`;
                    } else if (type === 'cutout') {
                        mikuCutout = img;
                        document.getElementById('preview-cutout').innerHTML = `<img src="${e.target.result}">`;
                    }
                    redraw();
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        function resetToDefaults() {
            if (!confirm('Reset all settings to defaults? This will not delete your uploaded images.')) return;
            
            document.getElementById('mainText').value = 'Miku';
            document.getElementById('subtitleText').value = 'Hatsune';
            document.getElementById('mainFont').value = 'Comic Sans MS';
            document.getElementById('subtitleFont').value = 'Trebuchet MS';
            document.getElementById('mainTextSize').value = 85;
            document.getElementById('subtitleTextSize').value = 38;
            document.getElementById('bannerShape').value = 'rounded';
            document.getElementById('bannerWidth').value = 780;
            document.getElementById('bannerHeight').value = 140;
            document.getElementById('bannerRotation').value = -3;
            document.getElementById('showSparkles').checked = true;
            document.getElementById('showDigitalCode').checked = true;
            document.getElementById('digitalCodeText').value = '01';
            document.getElementById('showMusicNotes').checked = true;
            document.getElementById('musicNoteSymbol').value = '‚ô™';
            document.getElementById('showTempBg').checked = false;
            
            syncColor('primaryColor', '#39C5BB');
            syncColor('accentColor', '#FF6B9D');
            syncColor('bannerColor', '#39C5BB');
            
            largeSizes = [330, 300, 280];
            largeRotations = [45, 15, -20];
            smallSizes = [80, 80, 80];
            smallRotations = [45, 45, 45];
            largeOpacity = [100, 100, 100];
            smallOpacity = [100, 100, 100];
            cutoutOpacity = 100;
            
            for (let i = 0; i < 3; i++) {
                document.getElementById(`size-large-${i + 1}`).value = largeSizes[i];
                document.getElementById(`rotation-large-${i + 1}`).value = largeRotations[i];
                document.getElementById(`opacity-large-${i + 1}`).value = largeOpacity[i];
                document.getElementById(`size-small-${i + 1}`).value = smallSizes[i];
                document.getElementById(`rotation-small-${i + 1}`).value = smallRotations[i];
                document.getElementById(`opacity-small-${i + 1}`).value = smallOpacity[i];
            }
            
            updateValue('mainSize', 85);
            updateValue('subtitleSize', 38);
            updateValue('bannerWidth', 780);
            updateValue('bannerHeight', 140);
            updateValue('bannerRot', -3);
            
            redraw();
        }
        
        function drawGradientSplash(x, y, radius, color, opacity = 0.6) {
            const gradient = ctx.createRadialGradient(x, y, 0, x, y, radius);
            gradient.addColorStop(0, color + Math.floor(opacity * 255).toString(16).padStart(2, '0'));
            gradient.addColorStop(0.5, color + '44');
            gradient.addColorStop(1, color + '00');
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }
        
        function drawImageInDiamond(img, x, y, size, rotation, opacity = 1.0) {
            if (!img) return;
            
            ctx.save();
            ctx.globalAlpha = opacity;
            ctx.translate(x, y);
            ctx.rotate(rotation * Math.PI / 180);
            
            ctx.beginPath();
            ctx.moveTo(0, -size);
            ctx.lineTo(size, 0);
            ctx.lineTo(0, size);
            ctx.lineTo(-size, 0);
            ctx.closePath();
            ctx.clip();
            
            const scale = Math.max(size * 2 / img.width, size * 2 / img.height);
            const scaledWidth = img.width * scale;
            const scaledHeight = img.height * scale;
            
            ctx.drawImage(img, -scaledWidth / 2, -scaledHeight / 2, scaledWidth, scaledHeight);
            
            ctx.restore();
            
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(rotation * Math.PI / 180);
            ctx.beginPath();
            ctx.moveTo(0, -size);
            ctx.lineTo(size, 0);
            ctx.lineTo(0, size);
            ctx.lineTo(-size, 0);
            ctx.closePath();
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 4;
            ctx.stroke();
            ctx.restore();
        }
        
        function drawImageInSmallDiamond(img, x, y, size, rotation, opacity = 1.0) {
            if (!img) {
                drawSmallDiamond(x, y, size, rotation);
                ctx.fillStyle = 'rgba(57, 197, 187, 0.3)';
                ctx.save();
                ctx.translate(x, y);
                ctx.rotate(rotation * Math.PI / 180);
                ctx.fillRect(-size/2, -size/2, size, size);
                ctx.restore();
                
                ctx.fillStyle = 'white';
                ctx.font = 'bold 36px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('M', x, y);
                return;
            }
            
            ctx.save();
            ctx.globalAlpha = opacity;
            ctx.translate(x, y);
            ctx.rotate(rotation * Math.PI / 180);
            
            ctx.beginPath();
            ctx.rect(-size/2, -size/2, size, size);
            ctx.clip();
            
            const scale = Math.max(size / img.width, size / img.height);
            const scaledWidth = img.width * scale;
            const scaledHeight = img.height * scale;
            
            ctx.drawImage(img, -scaledWidth / 2, -scaledHeight / 2, scaledWidth, scaledHeight);
            
            ctx.restore();
            
            drawSmallDiamond(x, y, size, rotation);
        }
        
        function drawDiamond(x, y, size, rotation, strokeWidth = 4) {
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(rotation * Math.PI / 180);
            
            ctx.beginPath();
            ctx.moveTo(0, -size);
            ctx.lineTo(size, 0);
            ctx.lineTo(0, size);
            ctx.lineTo(-size, 0);
            ctx.closePath();
            
            ctx.strokeStyle = 'white';
            ctx.lineWidth = strokeWidth;
            ctx.stroke();
            
            ctx.restore();
        }
        
        function drawSmallDiamond(x, y, size, rotation) {
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(rotation * Math.PI / 180);
            
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 3;
            ctx.strokeRect(-size/2, -size/2, size, size);
            
            ctx.restore();
        }
        
        function drawMikuCutout(img, x, y, maxHeight, opacity = 1.0) {
            if (!img) return;
            
            ctx.save();
            ctx.globalAlpha = opacity;
            
            const scale = maxHeight / img.height;
            const scaledWidth = img.width * scale;
            const scaledHeight = img.height * scale;
            
            ctx.shadowColor = primaryColor;
            ctx.shadowBlur = 30;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 0;
            
            ctx.drawImage(img, x - scaledWidth / 2, y - scaledHeight / 2, scaledWidth, scaledHeight);
            
            ctx.restore();
        }
        
        function drawBanner(x, y, width, height, rotation, text, subtext, shape) {
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(rotation * Math.PI / 180);
            
            const gradient = ctx.createLinearGradient(-width/2, 0, width/2, 0);
            gradient.addColorStop(0, bannerColor);
            gradient.addColorStop(0.5, '#00D1D6');
            gradient.addColorStop(1, bannerColor);
            
            ctx.fillStyle = gradient;
            
            // Draw shape based on selection
            if (shape === 'rounded') {
                const radius = 20;
                ctx.beginPath();
                ctx.moveTo(-width/2 + radius + 20, -height/2);
                ctx.lineTo(width/2 - radius, -height/2);
                ctx.arcTo(width/2, -height/2, width/2, -height/2 + radius, radius);
                ctx.lineTo(width/2 - 20, height/2 - radius);
                ctx.arcTo(width/2 - 20, height/2, width/2 - 20 - radius, height/2, radius);
                ctx.lineTo(-width/2 + radius, height/2);
                ctx.arcTo(-width/2, height/2, -width/2, height/2 - radius, radius);
                ctx.lineTo(-width/2 + 20, -height/2 + radius);
                ctx.arcTo(-width/2 + 20, -height/2, -width/2 + 20 + radius, -height/2, radius);
                ctx.closePath();
            } else if (shape === 'rectangle') {
                ctx.fillRect(-width/2, -height/2, width, height);
            } else if (shape === 'hexagon') {
                const w = width / 2;
                const h = height / 2;
                ctx.beginPath();
                ctx.moveTo(-w * 0.7, -h);
                ctx.lineTo(w * 0.7, -h);
                ctx.lineTo(w, 0);
                ctx.lineTo(w * 0.7, h);
                ctx.lineTo(-w * 0.7, h);
                ctx.lineTo(-w, 0);
                ctx.closePath();
            } else if (shape === 'ellipse') {
                ctx.beginPath();
                ctx.ellipse(0, 0, width/2, height/2, 0, 0, Math.PI * 2);
                ctx.closePath();
            } else if (shape === 'diamond') {
                ctx.beginPath();
                ctx.moveTo(0, -height/2);
                ctx.lineTo(width/2, 0);
                ctx.lineTo(0, height/2);
                ctx.lineTo(-width/2, 0);
                ctx.closePath();
            }
            
            ctx.fill();
            
            ctx.shadowColor = bannerColor;
            ctx.shadowBlur = 25;
            ctx.fill();
            ctx.shadowBlur = 0;
            
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 4;
            ctx.stroke();
            
            ctx.strokeStyle = accentColor;
            ctx.lineWidth = 2;
            ctx.globalAlpha = 0.6;
            ctx.stroke();
            ctx.globalAlpha = 1.0;
            
            // Draw text
            const mainFont = document.getElementById('mainFont').value;
            const subtitleFont = document.getElementById('subtitleFont').value;
            const mainSize = document.getElementById('mainTextSize').value;
            const subtitleSize = document.getElementById('subtitleTextSize').value;
            
            ctx.shadowColor = '#000000';
            ctx.shadowBlur = 15;
            ctx.shadowOffsetX = 5;
            ctx.shadowOffsetY = 5;
            
            ctx.font = `bold ${mainSize}px "${mainFont}", Impact`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            ctx.save();
            ctx.transform(1, 0, -0.15, 1, 0, 0);
            
            ctx.strokeStyle = accentColor;
            ctx.lineWidth = 12;
            ctx.strokeText(text, 0, -height/4);
            
            ctx.strokeStyle = primaryColor;
            ctx.lineWidth = 7;
            ctx.strokeText(text, 0, -height/4);
            
            ctx.strokeStyle = '#003333';
            ctx.lineWidth = 3;
            ctx.strokeText(text, 0, -height/4);
            
            ctx.fillStyle = 'white';
            ctx.fillText(text, 0, -height/4);
            
            ctx.shadowBlur = 0;
            ctx.globalAlpha = 0.5;
            const highlightGradient = ctx.createLinearGradient(0, -mainSize, 0, 0);
            highlightGradient.addColorStop(0, 'rgba(255, 255, 255, 0.9)');
            highlightGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
            ctx.fillStyle = highlightGradient;
            ctx.fillText(text, 0, -height/4);
            ctx.globalAlpha = 1.0;
            
            ctx.restore();
            
            ctx.shadowBlur = 10;
            ctx.font = `bold ${subtitleSize}px "${subtitleFont}", sans-serif`;
            
            ctx.strokeStyle = primaryColor;
            ctx.lineWidth = 6;
            ctx.strokeText(subtext, 0, height/4);
            
            ctx.strokeStyle = '#003333';
            ctx.lineWidth = 2;
            ctx.strokeText(subtext, 0, height/4);
            
            ctx.fillStyle = 'white';
            ctx.fillText(subtext, 0, height/4);
            
            // Draw sparkles if enabled
            if (document.getElementById('showSparkles').checked) {
                ctx.shadowBlur = 0;
                const sparkles = [
                    {x: -width/2 + 80, y: -height/4},
                    {x: width/2 - 80, y: -height/4},
                    {x: -width/3, y: height/3},
                    {x: width/3, y: height/3}
                ];
                
                sparkles.forEach(sparkle => {
                    drawSparkle(sparkle.x, sparkle.y, 6);
                });
            }
            
            ctx.restore();
        }
        
        function drawSparkle(x, y, size) {
            ctx.save();
            ctx.translate(x, y);
            
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.beginPath();
            
            for (let i = 0; i < 4; i++) {
                const angle = (Math.PI / 2) * i;
                const x1 = Math.cos(angle) * size;
                const y1 = Math.sin(angle) * size;
                
                if (i === 0) {
                    ctx.moveTo(x1, y1);
                } else {
                    const prevAngle = (Math.PI / 2) * (i - 1) + Math.PI / 4;
                    const prevX = Math.cos(prevAngle) * (size * 0.3);
                    const prevY = Math.sin(prevAngle) * (size * 0.3);
                    ctx.lineTo(prevX, prevY);
                    ctx.lineTo(x1, y1);
                }
            }
            
            ctx.closePath();
            ctx.fill();
            
            ctx.shadowColor = 'white';
            ctx.shadowBlur = 8;
            ctx.fill();
            
            ctx.restore();
        }
        
        function drawMusicNote(x, y, size, rotation = 0) {
            if (!document.getElementById('showMusicNotes').checked) return;
            
            const symbol = document.getElementById('musicNoteSymbol').value;
            
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(rotation * Math.PI / 180);
            
            ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.font = `${size}px Arial`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(symbol, 0, 0);
            
            ctx.restore();
        }
        
        function drawDigitalCode(x, y, opacity = 0.2) {
            if (!document.getElementById('showDigitalCode').checked) return;
            
            const codeText = document.getElementById('digitalCodeText').value || '01';
            
            ctx.save();
            ctx.fillStyle = `rgba(57, 197, 187, ${opacity})`;
            ctx.font = 'bold 200px Courier New';
            ctx.textAlign = 'center';
            ctx.fillText(codeText, x, y);
            ctx.restore();
        }
        
        function drawGlowingLine(x1, y1, x2, y2, color, width = 3) {
            ctx.save();
            ctx.strokeStyle = color;
            ctx.lineWidth = width;
            ctx.shadowColor = color;
            ctx.shadowBlur = 15;
            
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();
            
            ctx.restore();
        }
        
        function drawParticles() {
            ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
            for (let i = 0; i < 100; i++) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                const size = Math.random() * 3 + 1;
                
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        function redraw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw temp background if enabled
            if (document.getElementById('showTempBg').checked) {
                ctx.fillStyle = '#2e2828';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }
            
            drawGradientSplash(600, 500, 450, primaryColor, 0.5);
            drawGradientSplash(1000, 650, 400, '#00D1D6', 0.4);
            drawGradientSplash(1400, 400, 350, accentColor, 0.3);
            drawGradientSplash(800, 850, 380, primaryColor, 0.35);
            
            drawDigitalCode(500, 400, 0.15);
            drawDigitalCode(1600, 850, 0.15);
            
            drawParticles();
            
            drawGlowingLine(400, 300, 1700, 400, primaryColor, 2);
            drawGlowingLine(450, 950, 1600, 850, accentColor, 2);
            drawGlowingLine(300, 600, 550, 400, '#00D1D6', 2);
            
            if (mikuCutout) {
                drawMikuCutout(mikuCutout, 380, 600, 900, cutoutOpacity / 100);
            }
            
            const largeDiamonds = [
                { x: 920, y: 450 },
                { x: 1250, y: 600 },
                { x: 1530, y: 400 }
            ];
            
            largeDiamonds.forEach((diamond, index) => {
                if (largeImages[index]) {
                    drawImageInDiamond(
                        largeImages[index], 
                        diamond.x, 
                        diamond.y, 
                        largeSizes[index], 
                        largeRotations[index], 
                        largeOpacity[index] / 100
                    );
                } else {
                    drawDiamond(diamond.x, diamond.y, largeSizes[index], largeRotations[index], 4);
                }
            });
            
            const portraitX = 1830;
            const portraitYStart = 700;
            for (let i = 0; i < 3; i++) {
                const y = portraitYStart + (i * 130);
                drawImageInSmallDiamond(
                    smallImages[i], 
                    portraitX, 
                    y, 
                    smallSizes[i], 
                    smallRotations[i], 
                    smallOpacity[i] / 100
                );
            }
            
            drawMusicNote(620, 320, 48, 15);
            drawMusicNote(1420, 280, 56, -20);
            drawMusicNote(1650, 520, 40, 10);
            drawMusicNote(850, 920, 44, -15);
            drawMusicNote(1230, 970, 52, 25);
            drawMusicNote(400, 720, 36, 0);
            
            const mainText = document.getElementById('mainText').value || 'Miku';
            const subtitleText = document.getElementById('subtitleText').value || 'Hatsune';
            const bannerShape = document.getElementById('bannerShape').value;
            const bannerWidth = parseInt(document.getElementById('bannerWidth').value);
            const bannerHeight = parseInt(document.getElementById('bannerHeight').value);
            const bannerRotation = parseInt(document.getElementById('bannerRotation').value);
            
            drawBanner(1050, 800, bannerWidth, bannerHeight, bannerRotation, mainText, subtitleText, bannerShape);
            
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 1;
            for (let i = 0; i < 20; i++) {
                const x1 = SAFE_ZONE.x + 100 + Math.random() * (SAFE_ZONE.width - 200);
                const y1 = SAFE_ZONE.y + 100 + Math.random() * (SAFE_ZONE.height - 200);
                const length = Math.random() * 100 + 50;
                const angle = Math.random() * 360;
                const x2 = x1 + Math.cos(angle * Math.PI / 180) * length;
                const y2 = y1 + Math.sin(angle * Math.PI / 180) * length;
                
                ctx.beginPath();
                ctx.moveTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.stroke();
            }
        }
        
        function downloadImage() {
            const exportCanvas = document.createElement('canvas');
            exportCanvas.width = 1920;
            exportCanvas.height = 1080;
            const exportCtx = exportCanvas.getContext('2d');
            
            // Temporarily disable temp background
            const tempBgWasChecked = document.getElementById('showTempBg').checked;
            if (tempBgWasChecked) {
                document.getElementById('showTempBg').checked = false;
                redraw();
            }
            
            exportCtx.drawImage(
                canvas, 
                SAFE_ZONE.x, SAFE_ZONE.y, SAFE_ZONE.width, SAFE_ZONE.height,
                0, 0, 1920, 1080
            );
            
            // Restore temp background state
            if (tempBgWasChecked) {
                document.getElementById('showTempBg').checked = true;
                redraw();
            }
            
            const link = document.createElement('a');
            const mainText = document.getElementById('mainText').value.toLowerCase().replace(/\s+/g, '-');
            link.download = `${mainText}-profile-1920x1080.png`;
            link.href = exportCanvas.toDataURL('image/png');
            link.click();
        }
        
        redraw();
    </script>
</body>
</html>


